<div class="authorization-modules-container">
  <nz-card class="authorization-modules-card" [nzBordered]="false" [nzTitle]="cardTitleTpl" [nzExtra]="extraTpl">
    <!-- search form -->
    <div class="search-form-container">
      <form nz-form [formGroup]="formSearch" nz-form [nzLayout]="'vertical'">
        <div class="form-search-grid" nz-row [nzGutter]="16">
          <div class="form-grid-item" nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label nzFor="code">{{ "base-fe.modules.code" | translate }}</nz-form-label>
              <nz-form-control>
                <input nz-input name="code" type="text" id="code" formControlName="code" trim="blur"
                  (keyup.enter)="search()">
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="form-grid-item" nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label nzFor="name">{{ "base-fe.modules.name" | translate }}</nz-form-label>
              <nz-form-control>
                <input nz-input name="name" type="text" id="name" formControlName="name" trim="blur" (keyup.enter)="search()">
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="form-grid-item" nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label nzFor="status">{{ "base-fe.common.status" | translate }}</nz-form-label>
              <nz-form-control>
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="{{ 'base-fe.common.status' | translate }}"
                  formControlName="status">
                  <nz-option nzLabel="{{ 'base-fe.common.active' | translate}}" [nzValue]="1"></nz-option>
                  <nz-option nzLabel="{{ 'base-fe.common.inactive' | translate}}" [nzValue]="0"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="form-grid-item" nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label nzFor="parentId">{{ "base-fe.modules.parent" | translate }}</nz-form-label>
              <nz-form-control>
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="{{ 'base-fe.modules.parent' | translate }}"
                  formControlName="parentId">
                  <nz-option *ngFor="let parent of listParentModules" [nzLabel]="parent.parentName"
                    [nzValue]="parent.parentId"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
      </form>
      <div class="search-btn-container">
        <button nz-button (click)="search()"><span nz-icon nzType="search" nzTheme="outline"></span> {{
          'base-fe.common.search' | translate }}</button>
      </div>
    </div>
    <!-- table modules -->
    <nz-table #modulesTbl [nzData]="listModules" [nzFrontPagination]="false" [nzTotal]="total" [nzPageIndex]="pagination.page + 1"
      [nzPageSize]="pagination.size" (nzPageIndexChange)="onChangePageIndex($event)" [nzShowTotal]="totalTpl"
      [nzNoResult]="noDataTpl" [nzLoading]="loading">
      <thead>
        <tr>
          <th nzAlign="center">{{ "base-fe.common.stt" | translate }}</th>
          <th>{{ "base-fe.modules.code" | translate }}</th>
          <th>{{ "base-fe.modules.name" | translate }}</th>
          <th>{{ "base-fe.common.updated-date" | translate }}</th>
          <th>{{ "base-fe.common.status" | translate }}</th>
          <th>{{ "base-fe.modules.path" | translate }}</th>
          <th>{{ "base-fe.common.more-actions" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of modulesTbl.data; index as ind">
          <td nzAlign="center">{{ ind + 1 + pagination.page * pagination.size }}</td>
          <td>{{ data.code }}</td>
          <td>{{ data.name }}</td>
          <td>{{ data.updateTime | date: "dd/MM/yyyy hh:mm:ss" }}</td>
          <td>{{ data.status | statusCommon }}</td>
          <td>{{ data.pathUrl }}</td>
          <td class="action-btns">
            <button nz-button nzType="default" nzShape="circle" [title]="'base-fe.modules.edit-module'|translate"
              (click)="updateModule(data)" [baseFeHasPermission]="actionCodesPages.modulePage.update"><span nz-icon
                nzType="edit" nzTheme="fill"></span></button>
            <button nz-button nzType="default" nzShape="circle" [title]="'base-fe.modules.map-module-action'|translate"
              (click)="onMappingModuleAction(data)" [baseFeHasPermission]="actionCodesPages.modulePage.mapModuleAction">
              <span nz-icon nzType="setting" nzTheme="fill"></span>
            </button>
            <button nz-button nzDanger nzShape="circle" [title]="'base-fe.modules.delete-module'|translate"
              (click)="deleteModule(data)" [baseFeHasPermission]="actionCodesPages.modulePage.delete"><span nz-icon
                nzType="delete" nzTheme="fill"></span></button>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </nz-card>
</div>

<ng-template #cardTitleTpl>
  <div class="authorization-modules-card-title">
    {{ "base-fe.modules.title" | translate }}
  </div>
</ng-template>

<ng-template #extraTpl>
  <button class="create-btn" nz-button nzType="primary" (click)="insertModule()"
    [baseFeHasPermission]="actionCodesPages.modulePage.insert">
    <span nz-icon nzType="plus" nzTheme="outline"></span>
    {{ "base-fe.modules.create-btn" | translate }}
  </button>
</ng-template>

<ng-template #totalTpl>
  {{ total }} {{ 'base-fe.common.num-of-records' | translate }}
</ng-template>

<ng-template #noDataTpl>
  <nz-empty nzNotFoundContent="{{ 'base-fe.common.no-data' | translate }}"></nz-empty>
</ng-template>