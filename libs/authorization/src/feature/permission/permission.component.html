<div class="authorization-permissions-container">
  <nz-card class="authorization-permissions-card" [nzBordered]="false" [nzTitle]="cardTitleTpl" [nzExtra]="extraTpl">
    <!-- search form -->
    <div class="search-form-container">
      <form nz-form [formGroup]="formSearch" nz-form [nzLayout]="'vertical'">
        <div class="form-search-grid" nz-row [nzGutter]="16">
          <div class="form-grid-item" nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label nzFor="code">{{ "base-fe.permissions.code" | translate }}</nz-form-label>
              <nz-form-control>
                <input nz-input name="code" type="text" id="code" formControlName="code" trim="blur"
                  (keyup.enter)="search()">
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="form-grid-item" nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label nzFor="name">{{ "base-fe.permissions.name" | translate }}</nz-form-label>
              <nz-form-control>
                <input nz-input name="name" type="text" id="name" formControlName="name" trim="blur" (keyup.enter)="search()">
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class="form-grid-item" nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label nzFor="status">{{ "base-fe.common.status" | translate }}</nz-form-label>
              <nz-form-control>
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="{{ 'base-fe.common.status' | translate }}"
                  formControlName="status">
                  <nz-option nzLabel="{{ 'base-fe.common.active' | translate}}" [nzValue]="1"></nz-option>
                  <nz-option nzLabel="{{ 'base-fe.common.inactive' | translate}}" [nzValue]="0"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
      </form>
      <div class="search-btn-container">
        <button nz-button (click)="search()" [baseFeHasPermission]="actionCodesPages.permissionPage.search"><span nz-icon nzType="search" nzTheme="outline"></span> {{
          'base-fe.common.search' | translate }}</button>
      </div>
    </div>
    <!-- table permissions -->
    <nz-table #permissionsTbl [nzData]="listPermissions" [nzFrontPagination]="false" [nzTotal]="total"
      [nzPageSize]="pagination.size" (nzPageIndexChange)="onChangePageIndex($event)" [nzShowTotal]="totalTpl"
      [nzNoResult]="noDataTpl" [nzLoading]="loading">
      <thead>
        <tr>
          <th>{{ "base-fe.common.stt" | translate }}</th>
          <th>{{ "base-fe.permissions.code" | translate }}</th>
          <th>{{ "base-fe.permissions.name" | translate }}</th>
          <th>{{ "base-fe.common.updated-date" | translate }}</th>
          <th>{{ "base-fe.common.status" | translate }}</th>
          <th>{{ "base-fe.common.description" | translate }}</th>
          <th>{{ "base-fe.common.more-actions" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of permissionsTbl.data; index as ind">
          <td>{{ ind + 1 + pagination.page * pagination.size }}</td>
          <td>{{ data.code }}</td>
          <td>{{ data.name }}</td>
          <td>{{ data.updateTime | date: "dd/MM/yyyy hh:mm:ss" }}</td>
          <td>{{ data.status | statusCommon }}</td>
          <td>{{ data.description }}</td>
          <td class="action-btns">
            <button nz-button nzType="default" nzShape="circle" [title]="'base-fe.permissions.edit-permission'|translate" (click)="updatePermisson(data)"><span nz-icon
                nzType="edit" nzTheme="fill" [baseFeHasPermission]="actionCodesPages.permissionPage.update"></span></button>
              <button nz-button nzType="default" nzShape="circle" [title]="'base-fe.permissions.map-permission-module'|translate"  (click)="onMappingPermissionModule(data)">
                <span nz-icon nzType="setting" nzTheme="fill" [baseFeHasPermission]="actionCodesPages.permissionPage.mapPermissionModule"></span>
              </button>
            <button nz-button nzDanger nzShape="circle" [title]="'base-fe.permissions.delete-permission'|translate" (click)="deletePermission(data)"><span nz-icon nzType="delete"
                nzTheme="fill" [baseFeHasPermission]="actionCodesPages.permissionPage.delete"></span></button>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </nz-card>
</div>

<ng-template #cardTitleTpl>
  <div class="authorization-permissions-card-title">
    {{ "base-fe.permissions.title" | translate }}
  </div>
</ng-template>

<ng-template #extraTpl>
  <button class="create-btn" nz-button nzType="primary" (click)="insertPermission()" [baseFeHasPermission]="actionCodesPages.permissionPage.insert">
    <span nz-icon nzType="plus" nzTheme="outline"></span>
    {{ "base-fe.permissions.create-btn" | translate }}
  </button>
</ng-template>

<ng-template #totalTpl>
  {{ total }} {{ 'base-fe.common.num-of-records' | translate }}
</ng-template>

<ng-template #noDataTpl>
  <nz-empty nzNotFoundContent="{{ 'base-fe.common.no-data' | translate }}"></nz-empty>
</ng-template>
